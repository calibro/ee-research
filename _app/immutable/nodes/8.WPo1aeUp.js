import{s as Z,c as j,f as z}from"../chunks/scheduler.xAzB39Af.js";import{S as x,i as ee,e as A,m as P,s as H,c as L,a as M,n as C,f as J,d as k,o as N,g as q,p as D,h as O,k as _,l as $,x as K,q as I,y as b,z as Q}from"../chunks/index.B_s6da1h.js";import{e as T,u as te,o as re}from"../chunks/each.qOIVZGY4.js";import{S as se,q as V,g as ae,a as le,b as oe}from"../chunks/index.BQ35IoUo.js";import{l as v,g as ne,c as ie}from"../chunks/download.DyvU1DVF.js";import{d as ue,C as ce}from"../chunks/circlePacking.BUbT2mzq.js";import{L as fe}from"../chunks/link.C2wbuVwW.js";import{b as pe}from"../chunks/paths.DPUbilEK.js";function B(i,t,a){const n=i.slice();return n[16]=t[a],n[18]=a,n}function F(i){let t=[],a=new Map,n,r,o=T(i[4]);const l=e=>{var s;return`${e[1]}-${e[2]}-${e[18]}-${(s=e[16])==null?void 0:s[0]}`};for(let e=0;e<o.length;e+=1){let s=B(i,o,e),u=l(s);a.set(u,t[e]=G(u,s))}return{c(){for(let e=0;e<t.length;e+=1)t[e].c();n=b()},l(e){for(let s=0;s<t.length;s+=1)t[s].l(e);n=b()},m(e,s){for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,s);q(e,n,s),r=!0},p(e,s){s&534&&(o=T(e[4]),Q(),t=te(t,s,l,1,e,o,a,n.parentNode,re,G,n,B),K())},i(e){if(!r){for(let s=0;s<o.length;s+=1)_(t[s]);r=!0}},o(e){for(let s=0;s<t.length;s+=1)$(t[s]);r=!1},d(e){e&&k(n);for(let s=0;s<t.length;s+=1)t[s].d(e)}}}function me(i){let t,a,n;return t=new ce({props:{cluster:i[16]}}),{c(){P(t.$$.fragment),a=H()},l(r){C(t.$$.fragment,r),a=J(r)},m(r,o){D(t,r,o),q(r,a,o),n=!0},p(r,o){const l={};o&16&&(l.cluster=r[16]),t.$set(l)},i(r){n||(_(t.$$.fragment,r),n=!0)},o(r){$(t.$$.fragment,r),n=!1},d(r){r&&k(a),I(t,r)}}}function G(i,t){let a,n,r;return n=new fe({props:{url:t[9](t[16]),class:"contents",$$slots:{default:[me]},$$scope:{ctx:t}}}),{key:i,first:null,c(){a=b(),P(n.$$.fragment),this.h()},l(o){a=b(),C(n.$$.fragment,o),this.h()},h(){this.first=a},m(o,l){q(o,a,l),D(n,o,l),r=!0},p(o,l){t=o;const e={};l&16&&(e.url=t[9](t[16])),l&524304&&(e.$$scope={dirty:l,ctx:t}),n.$set(e)},i(o){r||(_(n.$$.fragment,o),r=!0)},o(o){$(n.$$.fragment,o),r=!1},d(o){o&&k(a),I(n,o)}}}function ge(i){let t,a,n,r,o;a=new se({props:{queries:i[3],dataUrl:i[5],description:i[6]("description"),question:i[6]("research_question")}});let l=i[0]&&F(i);return{c(){t=A("div"),P(a.$$.fragment),n=H(),r=A("div"),l&&l.c(),this.h()},l(e){t=L(e,"DIV",{class:!0});var s=M(t);C(a.$$.fragment,s),n=J(s),r=L(s,"DIV",{class:!0});var u=M(r);l&&l.l(u),u.forEach(k),s.forEach(k),this.h()},h(){N(r,"class","container p-s grid-1-s s:grid-2-s xl:grid-3-s xxl:grid-4-s svelte-1bhb5im"),N(t,"class","page l:flex-start-start")},m(e,s){q(e,t,s),D(a,t,null),O(t,n),O(t,r),l&&l.m(r,null),o=!0},p(e,[s]){const u={};s&8&&(u.queries=e[3]),s&32&&(u.dataUrl=e[5]),a.$set(u),e[0]?l?(l.p(e,s),s&1&&_(l,1)):(l=F(e),l.c(),_(l,1),l.m(r,null)):l&&(Q(),$(l,1,1,()=>{l=null}),K())},i(e){o||(_(a.$$.fragment,e),_(l),o=!0)},o(e){$(a.$$.fragment,e),$(l),o=!1},d(e){e&&k(t),I(a),l&&l.d()}}}function _e(i,t,a){let n,r,o,l,e,s,u,m;const R=le("tiktok");let g,f,w=!1,S=V("query");j(i,S,c=>a(1,u=c));let E=V("lang");j(i,E,c=>a(2,m=c));const W=async(c=(h=>(h=Object.keys(v))==null?void 0:h[0])())=>{var d;if(w||!oe)return;w=!0;const{data:y,error:p}=await ne({key:`tiktok-${c}-data`,url:e,type:"text"});y?(a(10,f=ie(y)),g!=null&&g.length||(a(3,g=[]),f.forEach(U=>{g.find(Y=>Y.slug===U.querySlug)||g.push({slug:U.querySlug,title:U.query})}),u||z(S,u=(d=g[0])==null?void 0:d.slug,u),m||z(E,m=c,m))):a(10,f=null),w=!1},X=c=>{const h=c==null?void 0:c[0];return`/tiktok/${m}/${u}/${h}`};return i.$$.update=()=>{var c,h,y;i.$$.dirty&1030&&a(0,n=(f==null?void 0:f.length)&&u&&m),i.$$.dirty&4&&a(12,r=((c=v)==null?void 0:c[m])||((h=v)==null?void 0:h.us)),i.$$.dirty&1026&&a(11,o=(y=f==null?void 0:f.filter)==null?void 0:y.call(f,p=>(p==null?void 0:p.querySlug)===u)),i.$$.dirty&4096&&a(13,l=`${pe}/assets/tiktok/${r==null?void 0:r.code}`),i.$$.dirty&12288&&a(5,e=r?`${l}/clusters_${r.code}.csv`:null),i.$$.dirty&4096&&W(r==null?void 0:r.code),i.$$.dirty&2049&&a(4,s=n?ae(o,p=>p.cluster).map(p=>(p[2]=[...new Set(p[1].map(d=>d.ids.split("|")).flat())].length,p)).sort((p,d)=>ue(p[2],d[2])):[])},[n,u,m,g,s,e,R,S,E,X,f,o,r,l]}class Se extends x{constructor(t){super(),ee(this,t,_e,ge,Z,{})}}export{Se as component};
