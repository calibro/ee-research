import{s as Z,c as j,f as z}from"../chunks/scheduler.xAzB39Af.js";import{S as x,i as ee,e as A,m as C,s as H,c as L,a as M,n as D,f as J,d as $,o as N,g as q,p as U,h as O,k as _,l as k,x as K,q as I,y as b,z as Q}from"../chunks/index.Byt9v-am.js";import{e as T,u as te,o as re}from"../chunks/each.Bv90klXA.js";import{S as se,q as V,g as ae,a as le,b as oe}from"../chunks/index.DVmt29A5.js";import{l as P,g as ne,c as ie}from"../chunks/download.BqV-rfyR.js";import{d as ce,C as ue}from"../chunks/circlePacking.B900PBM5.js";import{L as fe}from"../chunks/link.hHwDy82e.js";import{b as pe}from"../chunks/paths.CDNubtT_.js";function B(i,t,l){const n=i.slice();return n[16]=t[l],n[18]=l,n}function F(i){let t=[],l=new Map,n,r,o=T(i[4]);const a=e=>{var s;return`${e[1]}-${e[2]}-${e[18]}-${(s=e[16])==null?void 0:s[0]}`};for(let e=0;e<o.length;e+=1){let s=B(i,o,e),c=a(s);l.set(c,t[e]=G(c,s))}return{c(){for(let e=0;e<t.length;e+=1)t[e].c();n=b()},l(e){for(let s=0;s<t.length;s+=1)t[s].l(e);n=b()},m(e,s){for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,s);q(e,n,s),r=!0},p(e,s){s&278&&(o=T(e[4]),Q(),t=te(t,s,a,1,e,o,l,n.parentNode,re,G,n,B),K())},i(e){if(!r){for(let s=0;s<o.length;s+=1)_(t[s]);r=!0}},o(e){for(let s=0;s<t.length;s+=1)k(t[s]);r=!1},d(e){e&&$(n);for(let s=0;s<t.length;s+=1)t[s].d(e)}}}function me(i){let t,l,n;return t=new ue({props:{cluster:i[16]}}),{c(){C(t.$$.fragment),l=H()},l(r){D(t.$$.fragment,r),l=J(r)},m(r,o){U(t,r,o),q(r,l,o),n=!0},p(r,o){const a={};o&16&&(a.cluster=r[16]),t.$set(a)},i(r){n||(_(t.$$.fragment,r),n=!0)},o(r){k(t.$$.fragment,r),n=!1},d(r){r&&$(l),I(t,r)}}}function G(i,t){let l,n,r;return n=new fe({props:{url:t[8](t[16]),class:"contents",$$slots:{default:[me]},$$scope:{ctx:t}}}),{key:i,first:null,c(){l=b(),C(n.$$.fragment),this.h()},l(o){l=b(),D(n.$$.fragment,o),this.h()},h(){this.first=l},m(o,a){q(o,l,a),U(n,o,a),r=!0},p(o,a){t=o;const e={};a&16&&(e.url=t[8](t[16])),a&524304&&(e.$$scope={dirty:a,ctx:t}),n.$set(e)},i(o){r||(_(n.$$.fragment,o),r=!0)},o(o){k(n.$$.fragment,o),r=!1},d(o){o&&$(l),I(n,o)}}}function ge(i){let t,l,n,r,o;l=new se({props:{queries:i[3],description:i[5]("description"),question:i[5]("research_question")}});let a=i[0]&&F(i);return{c(){t=A("div"),C(l.$$.fragment),n=H(),r=A("div"),a&&a.c(),this.h()},l(e){t=L(e,"DIV",{class:!0});var s=M(t);D(l.$$.fragment,s),n=J(s),r=L(s,"DIV",{class:!0});var c=M(r);a&&a.l(c),c.forEach($),s.forEach($),this.h()},h(){N(r,"class","container p-s grid-1-s s:grid-2-s xl:grid-3-s xxl:grid-4-s svelte-1bhb5im"),N(t,"class","page l:flex-start-start")},m(e,s){q(e,t,s),U(l,t,null),O(t,n),O(t,r),a&&a.m(r,null),o=!0},p(e,[s]){const c={};s&8&&(c.queries=e[3]),l.$set(c),e[0]?a?(a.p(e,s),s&1&&_(a,1)):(a=F(e),a.c(),_(a,1),a.m(r,null)):a&&(Q(),k(a,1,1,()=>{a=null}),K())},i(e){o||(_(l.$$.fragment,e),_(a),o=!0)},o(e){k(l.$$.fragment,e),k(a),o=!1},d(e){e&&$(t),I(l),a&&a.d()}}}function _e(i,t,l){let n,r,o,a,e,s,c,m;const R=le("getty_circulation");let g,f,w=!1,S=V("query");j(i,S,u=>l(1,c=u));let v=V("lang");j(i,v,u=>l(2,m=u));const W=async(u=(h=>(h=Object.keys(P))==null?void 0:h[0])())=>{var d;if(w||!oe)return;w=!0;const{data:y,error:p}=await ne({key:`tiktok-${u}-data`,url:e,type:"text"});y?(l(9,f=ie(y)),g!=null&&g.length||(l(3,g=[]),f.forEach(E=>{g.find(Y=>Y.slug===E.querySlug)||g.push({slug:E.querySlug,title:E.query})}),c||z(S,c=(d=g[0])==null?void 0:d.slug,c),m||z(v,m=u,m))):l(9,f=null),w=!1},X=u=>{const h=u==null?void 0:u[0];return`/tiktok/${m}/${c}/${h}`};return i.$$.update=()=>{var u,h,y;i.$$.dirty&518&&l(0,n=(f==null?void 0:f.length)&&c&&m),i.$$.dirty&4&&l(11,r=((u=P)==null?void 0:u[m])||((h=P)==null?void 0:h.us)),i.$$.dirty&514&&l(10,o=(y=f==null?void 0:f.filter)==null?void 0:y.call(f,p=>(p==null?void 0:p.querySlug)===c)),i.$$.dirty&2048&&l(12,a=`${pe}/assets/tiktok/${r==null?void 0:r.code}`),i.$$.dirty&6144&&(e=r?`${a}/clusters_${r.code}.csv`:null),i.$$.dirty&2048&&W(r==null?void 0:r.code),i.$$.dirty&1025&&l(4,s=n?ae(o,p=>p.cluster).map(p=>(p[2]=[...new Set(p[1].map(d=>d.ids.split("|")).flat())].length,p)).sort((p,d)=>ce(p[2],d[2])):[])},[n,c,m,g,s,R,S,v,X,f,o,r,a]}class Se extends x{constructor(t){super(),ee(this,t,_e,ge,Z,{})}}export{Se as component};
