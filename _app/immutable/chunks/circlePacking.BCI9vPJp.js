import{s as $e,q as Ae,n as ke,r as Me}from"./scheduler.DcWYute-.js";import{S as je,i as ze,e as K,s as X,r as T,y as E,m as Q,c as U,a as j,f as Y,u as F,d as w,n as B,o as _,g as z,h as M,p as ee,B as N,k as C,z as Ce,l as q,x as Ee,G as se,q as te,C as O,I as oe,t as Ne,b as qe}from"./index.A1dMqo_u.js";import{e as P}from"./each.D85O8naZ.js";import"./download.CkaISNyS.js";import{f as le}from"./index.Cf4vGtW9.js";import{T as ne}from"./text.BQxw4Bn8.js";const Re=!0,qt=Re;function Rt(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}class Se extends Map{constructor(t,n=Oe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(ue(this,t))}has(t){return super.has(ue(this,t))}set(t,n){return super.set(Ie(this,t),n)}delete(t){return super.delete(De(this,t))}}function ue({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function Ie({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function De({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(n),e.delete(r)),n}function Oe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Pe(e){return e}function St(e,...t){return Le(e,Array.from,Pe,t)}function Le(e,t,n,r){return function i(s,o){if(o>=r.length)return n(s);const l=new Se,a=r[o++];let c=-1;for(const d of s){const m=a(d,++c,s),k=l.get(m);k?k.push(d):l.set(m,[d])}for(const[d,m]of l)l.set(d,i(m,o));return t(l)}(e,0)}function Ve(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function We(){return this.eachAfter(Ve)}function Te(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function Fe(e,t){for(var n=this,r=[n],i,s,o=-1;n=r.pop();)if(e.call(t,n,++o,this),i=n.children)for(s=i.length-1;s>=0;--s)r.push(i[s]);return this}function Ge(e,t){for(var n=this,r=[n],i=[],s,o,l,a=-1;n=r.pop();)if(i.push(n),s=n.children)for(o=0,l=s.length;o<l;++o)r.push(s[o]);for(;n=i.pop();)e.call(t,n,++a,this);return this}function He(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function Xe(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function Ye(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Ze(e){for(var t=this,n=Je(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function Je(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function Ke(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Qe(){return Array.from(this)}function Ue(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Be(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*et(){var e=this,t,n=[e],r,i,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,s=r.length;i<s;++i)n.push(r[i]);while(n.length)}function re(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=rt)):t===void 0&&(t=nt);for(var n=new W(e),r,i=[n],s,o,l,a;r=i.pop();)if((o=t(r.data))&&(a=(o=Array.from(o)).length))for(r.children=o,l=a-1;l>=0;--l)i.push(s=o[l]=new W(o[l])),s.parent=r,s.depth=r.depth+1;return n.eachBefore(st)}function tt(){return re(this).eachBefore(it)}function nt(e){return e.children}function rt(e){return Array.isArray(e)?e[1]:null}function it(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function st(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function W(e){this.data=e,this.depth=this.height=0,this.parent=null}W.prototype=re.prototype={constructor:W,count:We,each:Te,eachAfter:Ge,eachBefore:Fe,find:He,sum:Xe,sort:Ye,path:Ze,ancestors:Ke,descendants:Qe,leaves:Ue,links:Be,copy:tt,[Symbol.iterator]:et};function ot(e){return e==null?null:lt(e)}function lt(e){if(typeof e!="function")throw new Error;return e}function ae(){return 0}function ut(e){return function(){return e}}const at=1664525,ct=1013904223,ce=4294967296;function ft(){let e=1;return()=>(e=(at*e+ct)%ce)/ce}function ht(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function dt(e,t){let n=e.length,r,i;for(;n;)i=t()*n--|0,r=e[n],e[n]=e[i],e[i]=r;return e}function pt(e,t){for(var n=0,r=(e=dt(Array.from(e),t)).length,i=[],s,o;n<r;)s=e[n],o&&we(o,s)?++n:(o=mt(i=_t(i,s)),n=0);return o}function _t(e,t){var n,r;if(Z(t,e))return[t];for(n=0;n<e.length;++n)if(L(t,e[n])&&Z(R(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(L(R(e[n],e[r]),t)&&L(R(e[n],t),e[r])&&L(R(e[r],t),e[n])&&Z(be(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function L(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function we(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function Z(e,t){for(var n=0;n<t.length;++n)if(!we(e,t[n]))return!1;return!0}function mt(e){switch(e.length){case 1:return yt(e[0]);case 2:return R(e[0],e[1]);case 3:return be(e[0],e[1],e[2])}}function yt(e){return{x:e.x,y:e.y,r:e.r}}function R(e,t){var n=e.x,r=e.y,i=e.r,s=t.x,o=t.y,l=t.r,a=s-n,c=o-r,d=l-i,m=Math.sqrt(a*a+c*c);return{x:(n+s+a/m*d)/2,y:(r+o+c/m*d)/2,r:(m+i+l)/2}}function be(e,t,n){var r=e.x,i=e.y,s=e.r,o=t.x,l=t.y,a=t.r,c=n.x,d=n.y,m=n.r,k=r-o,p=r-c,b=i-l,h=i-d,$=a-s,y=m-s,u=r*r+i*i-s*s,g=u-o*o-l*l+a*a,v=u-c*c-d*d+m*m,x=p*b-k*h,f=(b*v-h*g)/(x*2)-r,A=(h*$-b*y)/x,S=(p*g-k*v)/(x*2)-i,I=(k*y-p*$)/x,G=A*A+I*I-1,D=2*(s+f*A+S*I),ie=f*f+S*S-s*s,H=-(Math.abs(G)>1e-6?(D+Math.sqrt(D*D-4*G*ie))/(2*G):ie/D);return{x:r+f+A*H,y:i+S+I*H,r:H}}function fe(e,t,n){var r=e.x-t.x,i,s,o=e.y-t.y,l,a,c=r*r+o*o;c?(s=t.r+n.r,s*=s,a=e.r+n.r,a*=a,s>a?(i=(c+a-s)/(2*c),l=Math.sqrt(Math.max(0,a/c-i*i)),n.x=e.x-i*r-l*o,n.y=e.y-i*o+l*r):(i=(c+s-a)/(2*c),l=Math.sqrt(Math.max(0,s/c-i*i)),n.x=t.x+i*r-l*o,n.y=t.y+i*o+l*r)):(n.x=t.x+n.r,n.y=t.y)}function he(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function de(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,s=(t.y*n.r+n.y*t.r)/r;return i*i+s*s}function V(e){this._=e,this.next=null,this.previous=null}function gt(e,t){if(!(s=(e=ht(e)).length))return 0;var n,r,i,s,o,l,a,c,d,m,k;if(n=e[0],n.x=0,n.y=0,!(s>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(s>2))return n.r+r.r;fe(r,n,i=e[2]),n=new V(n),r=new V(r),i=new V(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(a=3;a<s;++a){fe(n._,r._,i=e[a]),i=new V(i),c=r.next,d=n.previous,m=r._.r,k=n._.r;do if(m<=k){if(he(c._,i._)){r=c,n.next=r,r.previous=n,--a;continue e}m+=c._.r,c=c.next}else{if(he(d._,i._)){n=d,n.next=r,r.previous=n,--a;continue e}k+=d._.r,d=d.previous}while(c!==d.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,o=de(n);(i=i.next)!==r;)(l=de(i))<o&&(n=i,o=l);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=pt(n,t),a=0;a<s;++a)n=e[a],n.x-=i.x,n.y-=i.y;return i.r}function vt(e){return Math.sqrt(e.value)}function xt(){var e=null,t=1,n=1,r=ae;function i(s){const o=ft();return s.x=t/2,s.y=n/2,e?s.eachBefore(pe(e)).eachAfter(J(r,.5,o)).eachBefore(_e(1)):s.eachBefore(pe(vt)).eachAfter(J(ae,1,o)).eachAfter(J(r,s.r/Math.min(t,n),o)).eachBefore(_e(Math.min(t,n)/(2*s.r))),s}return i.radius=function(s){return arguments.length?(e=ot(s),i):e},i.size=function(s){return arguments.length?(t=+s[0],n=+s[1],i):[t,n]},i.padding=function(s){return arguments.length?(r=typeof s=="function"?s:ut(+s),i):r},i}function pe(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function J(e,t,n){return function(r){if(i=r.children){var i,s,o=i.length,l=e(r)*t||0,a;if(l)for(s=0;s<o;++s)i[s].r+=l;if(a=gt(i,n),l)for(s=0;s<o;++s)i[s].r-=l;r.r=a+l}}}function _e(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function me(e,t,n){const r=e.slice();return r[12]=t[n],r}function ye(e,t,n){const r=e.slice();return r[12]=t[n],r}function ge(e){var s;let t,n,r,i;return n=new ne({props:{typo:"small",content:(s=e[2].data)==null?void 0:s.text,class:"px-xs py-xxs",ellipsis:!0}}),{c(){t=K("div"),Q(n.$$.fragment),this.h()},l(o){t=U(o,"DIV",{class:!0,style:!0});var l=j(t);B(n.$$.fragment,l),l.forEach(w),this.h()},h(){_(t,"class","tooltip svelte-ijmvzk"),O(t,"--top",e[1].y+"px"),O(t,"--left",e[1].x+"px")},m(o,l){z(o,t,l),ee(n,t,null),i=!0},p(o,l){var c;const a={};l&4&&(a.content=(c=o[2].data)==null?void 0:c.text),n.$set(a),(!i||l&2)&&O(t,"--top",o[1].y+"px"),(!i||l&2)&&O(t,"--left",o[1].x+"px")},i(o){i||(C(n.$$.fragment,o),o&&Ae(()=>{i&&(r||(r=oe(t,le,{duration:150},!0)),r.run(1))}),i=!0)},o(o){q(n.$$.fragment,o),o&&(r||(r=oe(t,le,{duration:150},!1)),r.run(0)),i=!1},d(o){o&&w(t),te(n),o&&r&&r.end()}}}function kt(e){let t,n,r;function i(){return e[7](e[12])}function s(){return e[8](e[12])}return{c(){t=T("circle"),this.h()},l(o){t=F(o,"circle",{class:!0,cx:!0,cy:!0,r:!0,role:!0,fill:!0,tabindex:!0}),j(t).forEach(w),this.h()},h(){var o;_(t,"class","tooltip-actor svelte-ijmvzk"),_(t,"cx",e[12].x),_(t,"cy",e[12].y),_(t,"r",e[12].r),_(t,"role","tooltip"),_(t,"fill",(o=e[12].data)==null?void 0:o.color),_(t,"tabindex","-1")},m(o,l){z(o,t,l),n||(r=[N(t,"mouseover",i),N(t,"focus",s),N(t,"mouseout",e[9]),N(t,"blur",e[10])],n=!0)},p(o,l){e=o},d(o){o&&w(t),n=!1,Me(r)}}}function wt(e){let t;return{c(){t=T("circle"),this.h()},l(n){t=F(n,"circle",{cx:!0,cy:!0,r:!0,fill:!0,class:!0}),j(t).forEach(w),this.h()},h(){var n;_(t,"cx",e[12].x),_(t,"cy",e[12].y),_(t,"r",e[12].r),_(t,"fill",(n=e[12].data)==null?void 0:n.color),_(t,"class","svelte-ijmvzk")},m(n,r){z(n,t,r)},p:ke,d(n){n&&w(t)}}}function ve(e){let t;function n(s,o){return s[4](s[12].r)>6?wt:kt}let i=n(e)(e);return{c(){i.c(),t=E()},l(s){i.l(s),t=E()},m(s,o){i.m(s,o),z(s,t,o)},p(s,o){i.p(s,o)},d(s){s&&w(t),i.d(s)}}}function bt(e){var i;let t,n=((i=e[12].data)==null?void 0:i.text)+"",r;return{c(){t=T("text"),r=Ne(n),this.h()},l(s){t=F(s,"text",{x:!0,y:!0,"text-anchor":!0,"dominant-baseline":!0,"font-size":!0,class:!0});var o=j(t);r=qe(o,n),o.forEach(w),this.h()},h(){_(t,"x",e[12].x),_(t,"y",e[12].y),_(t,"text-anchor","middle"),_(t,"dominant-baseline","middle"),_(t,"font-size",e[4](e[12].r)),_(t,"class","svelte-ijmvzk")},m(s,o){z(s,t,o),M(t,r)},p:ke,d(s){s&&w(t)}}}function xe(e){let t=e[4](e[12].r)>6,n,r=t&&bt(e);return{c(){r&&r.c(),n=E()},l(i){r&&r.l(i),n=E()},m(i,s){r&&r.m(i,s),z(i,n,s)},p(i,s){t&&r.p(i,s)},d(i){i&&w(n),r&&r.d(i)}}}function $t(e){let t,n,r,i,s,o,l,a,c,d,m,k,p=e[2]&&ge(e),b=P(e[3]),h=[];for(let u=0;u<b.length;u+=1)h[u]=ve(ye(e,b,u));let $=P(e[3]),y=[];for(let u=0;u<$.length;u+=1)y[u]=xe(me(e,$,u));return l=new ne({props:{typo:"p",content:`${e[0][1][0].clusterLabel}`,class:"px-s py-xs",ellipsis:!0}}),c=new ne({props:{typo:"p",content:`tiktoks: ${e[0][2]}`,class:"px-s py-xs",ellipsis:!1}}),{c(){t=K("div"),p&&p.c(),n=X(),r=T("svg");for(let u=0;u<h.length;u+=1)h[u].c();i=E();for(let u=0;u<y.length;u+=1)y[u].c();s=X(),o=K("div"),Q(l.$$.fragment),a=X(),Q(c.$$.fragment),this.h()},l(u){t=U(u,"DIV",{class:!0,role:!0,tabindex:!0});var g=j(t);p&&p.l(g),n=Y(g),r=F(g,"svg",{width:!0,viewBox:!0,class:!0});var v=j(r);for(let f=0;f<h.length;f+=1)h[f].l(v);i=E();for(let f=0;f<y.length;f+=1)y[f].l(v);v.forEach(w),s=Y(g),o=U(g,"DIV",{class:!0});var x=j(o);B(l.$$.fragment,x),a=Y(x),B(c.$$.fragment,x),x.forEach(w),g.forEach(w),this.h()},h(){_(r,"width","100%"),_(r,"viewBox","0 0 200 200"),_(r,"class","ratio-square svelte-ijmvzk"),_(o,"class","title svelte-ijmvzk"),_(t,"class","circle-packing flex-col-center-start svelte-ijmvzk"),_(t,"role","button"),_(t,"tabindex","0")},m(u,g){z(u,t,g),p&&p.m(t,null),M(t,n),M(t,r);for(let v=0;v<h.length;v+=1)h[v]&&h[v].m(r,null);M(r,i);for(let v=0;v<y.length;v+=1)y[v]&&y[v].m(r,null);M(t,s),M(t,o),ee(l,o,null),M(o,a),ee(c,o,null),d=!0,m||(k=N(t,"mousemove",e[5]),m=!0)},p(u,[g]){if(u[2]?p?(p.p(u,g),g&4&&C(p,1)):(p=ge(u),p.c(),C(p,1),p.m(t,n)):p&&(Ce(),q(p,1,1,()=>{p=null}),Ee()),g&88){b=P(u[3]);let f;for(f=0;f<b.length;f+=1){const A=ye(u,b,f);h[f]?h[f].p(A,g):(h[f]=ve(A),h[f].c(),h[f].m(r,i))}for(;f<h.length;f+=1)h[f].d(1);h.length=b.length}if(g&24){$=P(u[3]);let f;for(f=0;f<$.length;f+=1){const A=me(u,$,f);y[f]?y[f].p(A,g):(y[f]=xe(A),y[f].c(),y[f].m(r,null))}for(;f<y.length;f+=1)y[f].d(1);y.length=$.length}const v={};g&1&&(v.content=`${u[0][1][0].clusterLabel}`),l.$set(v);const x={};g&1&&(x.content=`tiktoks: ${u[0][2]}`),c.$set(x)},i(u){d||(C(p),C(l.$$.fragment,u),C(c.$$.fragment,u),d=!0)},o(u){q(p),q(l.$$.fragment,u),q(c.$$.fragment,u),d=!1},d(u){u&&w(t),p&&p.d(),se(h,u),se(y,u),te(l),te(c),m=!1,k()}}}function At(e,t,n){let{cluster:r}=t;const s=((h,$,y)=>{const u=xt().size([$,y]).padding(5),g=re(h,x=>Array.isArray(x)?x[1]:null).sum(x=>x.videosNumber),v=u(g).descendants();return v.shift(),v})(r,200,200),o=h=>Math.min(h/3,13);let l={x:0,y:0};const a=h=>{n(1,l.x=h.clientX,l),n(1,l.y=h.clientY,l)};let c;const d=h=>{n(2,c=h)},m=h=>d(h),k=h=>d(h),p=()=>d(null),b=()=>d(null);return e.$$set=h=>{"cluster"in h&&n(0,r=h.cluster)},[r,l,c,s,o,a,d,m,k,p,b]}class It extends je{constructor(t){super(),ze(this,t,At,$t,$e,{cluster:0})}}export{It as C,qt as b,Rt as d,St as g};
